%!TEX program = xelatex

\documentclass[11pt,titlepage]{report}
\input{../../library/import}
\input{../../library/style}
\addbibresource{../../library/bibliography.bib}

\begin{document}

\chapter{Speed of sound}
\section{Derivation}
Let us derive an expression for the speed of sound with herein the dependency on environment temperature and humidity. From the Newton-Laplace equation for the speed of sound in a medium

\begin{equation}
	c = \sqrt{\frac{K}{\rho}},
\end{equation}

where $K$ is a coefficient of stiffness (the bulk modulus) and $\rho$ the density of the medium in conjunction with the fact that for a gas holds that

\begin{equation}
	K = \gamma p,
\end{equation}

where $\gamma$ denotes the \emph{adiabatic index} of the gas and $p$ its pressure, yields the following expression:

\begin{equation} \label{eq:c1}
	c = \sqrt{\gamma \frac{p}{\rho}}.
\end{equation}

Assuming $\gamma$ and $p$ (being the \emph{total air pressure}) are known, we now need to find an expression for the density of the water-air mixture, $\rho$.
To accomplish this, we utilize the ideal gas law

\begin{equation}
	p V = n R T,
\end{equation}

with $V$ the gas volume, $n$ the number of molecules, $R$ the specific gas constant and $T$ the absolute temperature in Kelvin, together with the definition of density $\rho = n / V$ to obtain:

\begin{equation}
	\rho = \frac{p}{R T}.
\end{equation}

Now, since the density of a mixture can be written as the sum of the densities of the individual gases, we can write:

\begin{equation} \label{eq:rho1}
	\rho_{air} = \frac{p_a}{R_a T} + \frac{p_w}{R_w T},
\end{equation}

where $p_a$, $R_a$, $p_w$ and $R_w$ are the pressures and specific gas constants for dry air and water vapor respectively. However, since we like to express air humidity as a ratio between the current partial water pressure $e_w$ and the saturation water pressure $e^*_w$ at a given temperature:

\begin{equation}
	\phi = \frac{e_w}{e^*_w} \times 100\%,
\end{equation}

we can use the fact that $p_a = p_{tot} - p_w$ and $p_w = e_w$ to rewrite \ref{eq:rho1}:

\begin{equation} \label{eq:rho2}
	\rho_{air} = \frac{R_w(100 p_{tot} - \phi e^*_w) + 100 R_a \phi e^*_w}{10^4 R_a R_w T},
\end{equation}

which we can then substitute back into \ref{eq:c1} to obtain the required expression:

\begin{equation} \label{eq:c2}
	c = \sqrt{\gamma \frac{10^4 p_{tot} R_a R_w T}{100 R_w(100 p_{tot} - \phi e^*_w) + 100 R_a \phi e^*_w}}.
\end{equation}
\cite{sengpiel-sound-speed,uiuc-rel-humid,wikipedia-speed-of-sound}

\section{Calculation}
Now, let us perform a calculation of the speed of sound in an environment of \SI{20}{\degree C} and a typical relative humidity of \SI{50}{\%}. We take $p_{tot}$ to be \SI{100}{kPa}, the standard atmospheric pressure, and it is given that $R_a = \SI{287.05}{J/kgK}$ and $R_w = \SI{461.495}{J/kgK}$ \cite{sengpiel-sound-speed}. Then we need to find a value for the adiabatic index $\gamma$. $\gamma$ is usually taken to be \num{1.67} for mono-atomic molecules, \num{1.4} for di-atomic molecules and \num{1.33} for tri-atomic molecules. Now, since air mostly consists of nitrogen and oxygen, which are di-atomic molecules, we take $\gamma = 1.4$ \cite{eng-tb-air-comp}. Lastly, we need a value for $e^*_w$. Buck \cite{buck-sat-press} presented an expression to approximate this value, but for this report it will suffice to make use of a table which presents the values of $e^*_w$ for different temperatures. In this manner, we find $e^*_w = \SI{2310}{Pa}$ for $T = \SI{20}{\degree C}$ \cite{eng-tb-sat-press}.
Substitution of the given values in \ref{eq:c2} yields:

\begin{equation}
	c = \sqrt{1.4 \frac{10^4 \cdot 100 \times 10^3 \cdot 287.05 \cdot 461.495 \cdot 293}{100 \cdot 461.495(100 \cdot 100 \times 10^3 - 50 \cdot 2310) + 100 \cdot 287.05 \cdot 50 \cdot 2310}} = \SI{343.90}{m/s}.
\end{equation}

\end{document}