%!TEX program = xelatex

\documentclass[11pt,titlepage]{report}
\input{../../library/import}
\input{../../library/style}
\addbibresource{../../library/bibliography.bib}

% Fancy comb dirac, can be ignored for now. For further use.
%
% \usepackage[OT2,T1]{fontenc}
% \newcommand{\sha}{\text{\fontencoding{OT2}\selectfont\char88}}
% \newcommand{\F}[1]{\operatorname{\mathcal{F}}\left\{#1\right\}}
% \begin{equation}
% 	\F{\operatorname{rect}(F_s t) \ast 2F_s \sha(2F_s t)}
% \end{equation}

\begin{document}

\section{Labday 2}
In this report the suitability of four test signals are investigated. Figure \ref{fig:ass-1-rep-8} shows the autocorrelation of all four signals.

\begin{figure}[H]
	\centering
	\begin{subfigure}{0.49\textwidth}
		\includegraphics[width=\textwidth]{../../deliverable-7-resources/figures/ass-1/report-8-9-10/report-8/ass-1-report-8-minimum-phase-minimum-phase.pdf}
		\caption{Autocorrelation of a minimum phase signal}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\includegraphics[width=\textwidth]{../../deliverable-7-resources/figures/ass-1/report-8-9-10/report-8/ass-1-report-8-maximum-phase-maximum-phase.pdf}
		\caption{Autocorrelation of a maximum phase signal}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\includegraphics[width=\textwidth]{../../deliverable-7-resources/figures/ass-1/report-8-9-10/report-8/ass-1-report-8-sinusoidal-sinusoidal.pdf}
		\caption{Autocorrelation of a sinusoidal signal}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\includegraphics[width=\textwidth]{../../deliverable-7-resources/figures/ass-1/report-8-9-10/report-8/ass-1-report-8-BPSK-BPSK.pdf}
		\caption{Autocorrelation of a BPSK signal}
	\end{subfigure}
	\caption{Autocorrelation sequences of each of the tested signals}
	\label{fig:ass-1-rep-8}
\end{figure}

The Matched Filter yields a channel estimation $\hat{h}[n]$ given by
\[
	\hat{h}[n] = h[n] \ast r[n]
\]
where $h[n]$ denotes the channel impulse response and $r[n]$ the training sequence's autocorrelation function. If we require that $\hat{n}[n] \rightarrow h[n]$, then obviously $r[n] \rightarrow \delta[n]$. Therefore, we require $r[n]$ to only have a peak at $n=0$. This makes the minimum phase of maximum phase signal the most suitable test signal. However, both have side lobes of $1/2.5$ the peak's height, so they are not optimal.
 

\subsection{Report 9}
Let $\hat{L}$ denote the lenght of the estimated channel impulse response $\hat{\vec{h}}$ and $L$ the length of the actual channel impulse response $\vec{h}$. Figure~\ref{fig:ass-1-rep-9-no-noise} shows the corrected channel estimation error $||\hat{\vec{h}}(\hat{\vec{h}} \cdot \vec{h})/(\hat{\vec{h}} \cdot \hat{\vec{h}}) - \vec{h}||$.
\begin{figure}[H]
	\centering
	\begin{subfigure}{0.49\textwidth}
		\includegraphics[width=\textwidth]{../../deliverable-7-resources/figures/ass-1/report-8-9-10/report-9-no-noise/ass-1-report-9-minimum-phase.pdf}
		\caption{\centering Channel estimation error for a minimum phase sequence}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\includegraphics[width=\textwidth]{../../deliverable-7-resources/figures/ass-1/report-8-9-10/report-9-no-noise/ass-1-report-9-maximum-phase.pdf}
		\caption{\centering Channel estimation error for a maximum phase sequence}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\includegraphics[width=\textwidth]{../../deliverable-7-resources/figures/ass-1/report-8-9-10/report-9-no-noise/ass-1-report-9-sinusoidal.pdf}
		\caption{\centering Channel estimation error for a sinusoidal sequence}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\includegraphics[width=\textwidth]{../../deliverable-7-resources/figures/ass-1/report-8-9-10/report-9-no-noise/ass-1-report-9-BPSK.pdf}
		\caption{\centering Channel estimation error for a BPSK sequence}
	\end{subfigure}
	\caption{The channel estimation error for increasing $\hat{L}$ without noise}
	\label{fig:ass-1-rep-9-no-noise}
\end{figure}

We see that projection, which is deconvolution by calculating the pseudo-inverse, clearly outperforms the matched estimation, which is the estimation by the Matched Filter. Also, projection requires to have $\hat{L} \ge L$ to perform optimally. The matched estimation performs optimally if $\hat{L} = L$. Therefore, we conclude that if $\hat{L}$ is large enough, only the matched estimation is sensitive to the choice of $
\hat{L}$.

Figure~\ref{fig:ass-1-rep-9-0.1} shows the channel estimation error with noise added. The STD $\sigma_{\text{noise}}$ of the noise added is given by $0.1$. We conclude that the conclusions of the previous paragraph still hold. Also, we see that for a large enough $\hat{L}$ the BPSK sequence is the least sensitive to noise. The minimum phase and maximum phase sequences have the least error for the matched estimation.

\begin{figure}[H]
	\centering
	\begin{subfigure}{0.49\textwidth}
		\includegraphics[width=\textwidth]{../../deliverable-7-resources/figures/ass-1/report-8-9-10/report-9-noise-0.1/ass-1-report-9-minimum-phase.pdf}
		\caption{\centering Channel estimation error for a minimum phase sequence}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\includegraphics[width=\textwidth]{../../deliverable-7-resources/figures/ass-1/report-8-9-10/report-9-noise-0.1/ass-1-report-9-maximum-phase.pdf}
		\caption{\centering Channel estimation error for a maximum phase sequence}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\includegraphics[width=\textwidth]{../../deliverable-7-resources/figures/ass-1/report-8-9-10/report-9-noise-0.1/ass-1-report-9-sinusoidal.pdf}
		\caption{\centering Channel estimation error for a sinusoidal sequence}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\includegraphics[width=\textwidth]{../../deliverable-7-resources/figures/ass-1/report-8-9-10/report-9-noise-0.1/ass-1-report-9-BPSK.pdf}
		\caption{\centering Channel estimation error for a BPSK sequence}
	\end{subfigure}
	\caption{The channel estimation error for increasing $\hat{L}$, with $\sigma_{\text{noise}} = 0.1$}
	\label{fig:ass-1-rep-9-0.1}
\end{figure}


\subsection{Report 10}
\label{subsec:ass-1-rep-10}
In this report we will discuss three aspects of our training sequence and the channel estimation; \textbf{(1)} the trainings sequence's length $N$, \textbf{(2)}, the estimated impulse response's length $\hat{L}$ and \textbf{(3)}, the properties of the training sequence itself.

The training sequence's length should be chosen in consideration with the properties of the training sequence itself so that \textbf{(a)}, an autocorrelation which resembles a delta function, \textbf{(b)}, a crosscorrelation with every other signal of zero and \textbf{(c)}, a minimal length to minimize computations and maximize speed are achieved. A trade-off has to be made between \textbf{(a)} and \textbf{(c)}, so these are design choices. Also, to satisfy \textbf{(c)}, $\hat{L}$ should be chosen so that it matches the actual channel impulse response's length $L$.
\end{document}