%!TEX program = xelatex

\documentclass[11pt,titlepage]{report}
\input{../../library/import}
\input{../../library/style}
\addbibresource{../../library/bibliography.bib}

\begin{document}

\chapter{Assignment 1}
\section{Task 1}

Following the definition for the characteristic impedance $Z_0$ and substituing $Z_s=\frac{1}{j\omega C}$ and $Z_p=j\omega L$ gives:
\begin{eqnarray}
Z_0=\frac{Z_s}{2} + \sqrt{\frac{Z_s^2}{4}+Z_sZ_p} \\
Z_0 = \frac{1}{2j\omega C} + \sqrt{\frac{L}{C}-\frac{1}{4\omega^2C^2}} 
\end{eqnarray}

For the propagation co\"efficient we have $\gamma = 1-\frac{Z_s}{Z_0}$, in which $Z_s$ and $Z_0$ may be substituted and the result simplified:
\begin{eqnarray}
\gamma = 1 - \frac{1}{j\omega C}\cdot\frac{1}{\frac{1}{2\omega C}+\sqrt{\frac{L}{C}-\frac{1}{4\omega^2C^2}}} \\
= 1 - \frac{1}{\frac{1}{2}+\sqrt{\frac{1}{4}-LC\omega^2}} = \frac{-\frac{1}{2}+\sqrt{\frac{1}{4}-LC\omega^2}}{\frac{1}{2}+\sqrt{\frac{1}{4}-LC\omega^2}}
\end{eqnarray}

From this last equality, the frequency behaviour of the ladder network may be obtained:
if $\omega\geq\sqrt{\frac{1}{4LC}}$ the result of $\sqrt{\frac{1}{4}-LC\omega^2}$ is an imaginary number which we shall call $jX$.
\begin{eqnarray}
\lvert\gamma\rvert = \frac{\lvert -\frac{1}{2}+jX \rvert}{\lvert \frac{1}{2}+jX \rvert} = \frac{\sqrt{\frac{1}{4}+X^2}}{\sqrt{\frac{1}{4}+X^2}}=1
\end{eqnarray}

if $\omega < \sqrt{\frac{1}{4LC}}$ the result of $\sqrt{\frac{1}{4}-LC\omega^2}$ is a positive real number which we shall call $X$.
\begin{eqnarray}
\lvert\gamma\rvert = \frac{\lvert -\frac{1}{2}+X \rvert}{\lvert \frac{1}{2}+X \rvert}
\end{eqnarray}
Since $X$ is positive, $\lvert\gamma\rvert < 1$ for all $\omega < \sqrt{\frac{1}{4LC}}$. 

Now it can be concluded that the ladder network is a high pass network because the transfer is unity for high frequencies and less than one for low frequencies. This was also expected because the ladder network described in section 5.1.2 of the reader is a low pass filter and in this scenario the inductor and capacitor have changed places, yielding the dual case: a high pass filter. The crossover frequency is the frequency on the border of unity gain and lower gain; $\omega_0=\sqrt{\frac{1}{4LC}}$.

\section{Task 2}
The general equation for the voltage across the channel is 
\begin{equation}
V(z,t)=U(t-\gamma z) + \Gamma U(t+\gamma(z-2l))-\Gamma U(t-\gamma(z+2l))-\Gamma^2U(t+\gamma(z-4l))\dots
\end{equation}
In which $\Gamma=\frac{Z_l-Z_0}{Z_l+Z_0}$.

For the case when at $z=l$ the terminal is open, $Z_l \to \infty$ and in the equation for $\Gamma$ $Z_0$ becomes negligible. Therefore, $\Gamma=1$ and 
\begin{equation}
V(z,t)=U(t-\gamma z) + U(t+\gamma(z-2l))- U(t-\gamma(z+2l))- U(t+\gamma(z-4l))\dots
\end{equation}

For the case when at $z=l$ the terminal is shorted, $Z_l \to 0$ and $\Gamma=-1$. Thus 
\begin{equation}
V(z,t)=U(t-\gamma z) - U(t+\gamma(z-2l))+U(t-\gamma(z+2l))-U(t+\gamma(z-4l))\dots
\end{equation}


\section{Task 3}
The characteristic impedance may be found using the formula $Z_0=\sqrt{\frac{L_0}{C_0}}$. For this particular case it gives $Z_0=\sqrt{\frac{0.5\cdot10^-6}{2\cdot10^-9}}=15.8\Omega$. 

The space-time plot of the voltage in the line is given in figure --insert data v.png--. This plot was obtained using the given \texttt{MATLAB} function \texttt{bscan\_plot.m} along with some computations: $\Gamma=\frac{Zl-Z0}{Zl+Z0}$, a \texttt{MATLAB} function for calculating the voltage at $x=0$ at a given time \texttt{U.m} and a \texttt{MATLAB} function for calculating $V(z,t)$ for a given $z,t$, \texttt{V.m}. Source code of these files may be found in --insert m files in appendix-- and they are referenced in the main program: \texttt{task3.m}.

Interesting to note about the voltage is that it moves back and forth throughout the transmission line: positive in the way from $x=0$ to $x=1.2$m and negative on its way back. The voltage is $\SI{\pm1}{V}$ throughout the line, except at the load, where it is lower. However, because power is dissipated, the voltage does fade over time.

The space-time plot of the current in the transmission line is given in figure --inserv data I.png--. The code used to create this plot is also in \texttt{task3.m}. Interestingly, there are two ways of calculating the current from equations (5.13) and (5.14) in the EPO manual, either by spatially integrating the voltage (5.13) or by integrating the voltage with respect to time (5.14). We chose the former, in the following way:
\begin{eqnarray}
\frac{\partial I(z,t)}{\partial z}=-C_0\frac{\partial V(z,t)}{\partial t} = I(z,t)=-C_0\int \! \frac{\partial V(z,t)}{\partial t}\, \mathrm{d}z \\
\approx -C_0\sum\frac{V(z,t+\Delta t)-V(z,t)}{\Delta t}\Delta z
\end{eqnarray}
In this way, $I(z,t)$ can be approximated by numerically integrating the voltage. 

The current plot also has some interesting features: it also produces traveling waves back and forth through the line although the current is positive at all times. It can also be seen that the initial condition $I(0,0)=0$ holds: the current is zero at the beginning. Moreover the current does not instantaniously change after $t=0$ as expected. Just as the voltage, the current also fades over time.

\section{Task 4}
The general reflection co\"efficient is given by 
\begin{equation}
\hat{\Gamma}(s)=\frac{Z_l-Z_0}{Z_l+Z_0}
\end{equation}
which in this case reduces to
\begin{equation}
\Gamma = \frac{Z_l-Z_0}{Z_l+Z_0}=\frac{50+j50-15.8}{50+j50+15.8}=0.70+j0.23
\end{equation}
because the latter is frequency independent.

Assuming the same feeding voltage pulse as in the previous exercise, we can Fourier transform the expression and use it to calculate $V(z,j\omega)$ using equation (5.29) in the EPO manual along with the found $\Gamma$ and the fact that $\beta=\omega\gamma=\omega\sqrt{C_0L_0}$. Since $U(t)=\epsilon(t)-\epsilon(t-t_w)$, $U(j\omega)=(\pi\delta(\omega)+\frac{1}{j\omega})(1-e^{-j\omega t_w})$.

Given the above, we can use \texttt{MATLAB} to create a Bode (magnitude) plot for $V(z,j\omega)\mid_{z=l=1.2}$. The code can be found in the appendix. (todo: insert matlab code, insert images). 

\end{document}